(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     70329,       1749]
NotebookOptionsPosition[     66050,       1679]
NotebookOutlinePosition[     66449,       1695]
CellTagsIndexPosition[     66406,       1692]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["LDPC code generator ", "Title",
 CellChangeTimes->{{3.970654447793283*^9, 
  3.970654483350422*^9}},ExpressionUUID->"5d3e0085-4626-4c45-8196-\
a32bc093ff3a"],

Cell["\<\
Duarte  Mateus
v0.1\
\>", "Subtitle",
 CellChangeTimes->{{3.9706544874512577`*^9, 
  3.970654501509079*^9}},ExpressionUUID->"19f90c68-791e-405a-a73a-\
8963bf01064a"],

Cell[TextData[{
 "Store on \n- ",
 StyleBox["m",
  FontSlant->"Italic"],
 " the number of rows, ",
 StyleBox[" \n- n ",
  FontSlant->"Italic"],
 "the number of  columns",
 "\n- c the Hamming weigth of the columns \n- threshold  the maximum allows \
intersection size\nThe following code will store M the support of the matrix"
}], "Text",
 CellChangeTimes->{{3.970654509108768*^9, 3.970654558625486*^9}, {
  3.97065458900259*^9, 
  3.97065467311476*^9}},ExpressionUUID->"99b53cfc-1d3e-40af-a5fc-\
332fccec28c1"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"m", "=", "9"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", "11"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Example", " ", "value", " ", "for", " ", "k"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"threshold", "=", "3"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Maximum", " ", "allowed", " ", "intersection", " ", "size"}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"set", "=", 
     RowBox[{"Range", "[", "m", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"allSubsets", "=", 
     RowBox[{"Subsets", "[", 
      RowBox[{"set", ",", 
       RowBox[{"{", "c", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MaxM", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"M", ",", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"x", ",", 
           RowBox[{"Plus", "@@", "x"}]}], "]"}], "/@", "M"}], "]"}]}], 
      "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntersectionMatrix", "[", 
     RowBox[{"subsets1_", ",", "subsets2_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Intersection", "[", 
        RowBox[{
         RowBox[{"subsets1", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"subsets2", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "subsets1", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", "subsets2", "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SelectSubsets", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"allsubsets", ",", "k", ",", "threshold"}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "selsub", ",", "remsub", ",", "potsub", ",", "imatrix", ",", "aux", 
           ",", "aux2", ",", "el", ",", "mmin", ",", "mmin2", ",", "pos", ",",
            "pos2", ",", "aux3", ",", "i"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"selsub", "=", 
           RowBox[{"{", 
            RowBox[{"First", "[", "allsubsets", "]"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"remsub", "=", 
           RowBox[{"Rest", "[", "allsubsets", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"mmin", "=", 
           RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"imatrix", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"IntersectionMatrix", "[", 
             RowBox[{"selsub", ",", "remsub"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "selsub", "]"}], "<", "k"}], " ", "&&", 
             " ", 
             RowBox[{"mmin", "<=", "threshold"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Length", "[", "remsub", "]"}], ">", "0"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"aux", "=", 
              RowBox[{"Map", "[", 
               RowBox[{"Max", ",", "imatrix"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"mmin", "=", 
              RowBox[{"Min", "[", "aux", "]"}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{"potsub", "=", 
              RowBox[{"remsub", "[", 
               RowBox[{"[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Position", "[", 
                  RowBox[{"aux", ",", "mmin"}], "]"}], "]"}], "]"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"aux2", "=", 
              RowBox[{"Apply", "[", 
               RowBox[{"Plus", ",", 
                RowBox[{"IntersectionMatrix", "[", 
                 RowBox[{"selsub", ",", "potsub"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"mmin2", "=", 
              RowBox[{"Min", "[", "aux2", "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"pos", "=", 
              RowBox[{"First", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{"aux2", ",", "mmin2"}], "]"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"el", "=", 
              RowBox[{"potsub", "[", 
               RowBox[{"[", "pos", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"selsub", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"selsub", ",", "el"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"pos2", "=", 
              RowBox[{"First", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{"remsub", ",", "el"}], "]"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"remsub", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"remsub", ",", "pos2"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"imatrix", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"imatrix", ",", "pos2"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"aux3", "=", 
              RowBox[{"Transpose", "[", 
               RowBox[{"IntersectionMatrix", "[", 
                RowBox[{
                 RowBox[{"{", "el", "}"}], ",", "remsub"}], "]"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"i", "++"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "<", "k"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"imatrix", "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"imatrix", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"aux3", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "aux3", "]"}]}], "}"}]}], "]"}]}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", "i", "]"}], ";"}]}], "\[IndentingNewLine]",
            "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"mmin", ">", "threshold"}], ",", 
            RowBox[{
            "Print", "[", 
             "\"\<There are not enough sets to fullfill the threeshold\>\"", 
             "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "mmin", "]"}], ";", "\[IndentingNewLine]", 
          "selsub"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.953029138555347*^9, 3.9530291606706553`*^9}, {
   3.9530293043159447`*^9, 3.953029357514975*^9}, 3.953029547020282*^9, {
   3.953029604755144*^9, 3.953029619045535*^9}, {3.953030149726646*^9, 
   3.953030173870693*^9}, {3.953030343807309*^9, 3.953030373742455*^9}, {
   3.953030820269411*^9, 3.953030989549819*^9}, {3.95303102390129*^9, 
   3.953031148118509*^9}, {3.953031200325976*^9, 3.9530312279298286`*^9}, {
   3.953031258423855*^9, 3.95303135865426*^9}, {3.953031395606976*^9, 
   3.953031406342012*^9}, {3.95303143860925*^9, 3.953031510271648*^9}, {
   3.953031771672811*^9, 3.953031798414043*^9}, {3.953031853294725*^9, 
   3.953031879743705*^9}, {3.953031950350164*^9, 3.953032031303906*^9}, {
   3.953032080318409*^9, 3.9530321169035673`*^9}, {3.953032152968856*^9, 
   3.953032220685079*^9}, {3.953032289035377*^9, 3.953032310236197*^9}, {
   3.953032366322694*^9, 3.953032370555069*^9}, {3.953032497997699*^9, 
   3.953032621155614*^9}, {3.95303266671586*^9, 3.953032674356253*^9}, {
   3.953033382180128*^9, 3.9530333822381973`*^9}, {3.953033512868202*^9, 
   3.953033513011249*^9}, {3.953033724102069*^9, 3.953033724208817*^9}, {
   3.953033774231848*^9, 3.953033774550049*^9}, {3.953038695784004*^9, 
   3.95303869586827*^9}, {3.953038974050873*^9, 3.953038974709958*^9}, {
   3.953039223952632*^9, 3.9530393038360853`*^9}, {3.953039528186253*^9, 
   3.953039540283349*^9}, {3.953039855370384*^9, 3.95303987139552*^9}, {
   3.9530399100584*^9, 3.95304015470963*^9}, {3.9530402555492487`*^9, 
   3.953040261819913*^9}, {3.953040351620179*^9, 3.953040358734838*^9}, {
   3.953040388846096*^9, 3.9530403911553497`*^9}, {3.953040430658566*^9, 
   3.953040432037036*^9}, {3.953040489126074*^9, 3.953040532831174*^9}, {
   3.953040595747451*^9, 3.9530406101372023`*^9}, {3.9530406771471853`*^9, 
   3.9530407048224792`*^9}, {3.953040734860402*^9, 3.953040765331915*^9}, {
   3.953040809458831*^9, 3.95304098813725*^9}, {3.953041033629298*^9, 
   3.953041112709272*^9}, {3.953041146656599*^9, 3.95304115119035*^9}, {
   3.953041543106598*^9, 3.953041543385038*^9}, {3.953042899402248*^9, 
   3.953042899554804*^9}, {3.953044922477463*^9, 3.953044923160217*^9}, {
   3.953045796533443*^9, 3.953045806372946*^9}, {3.953046167807959*^9, 
   3.953046169779955*^9}, {3.953046504172482*^9, 3.953046508621455*^9}, {
   3.953046609177134*^9, 3.953046622392053*^9}, {3.95304688579615*^9, 
   3.953046886720656*^9}, {3.9530471983784523`*^9, 3.953047198886592*^9}, {
   3.953643620831958*^9, 3.953643630449233*^9}, {3.953645197679369*^9, 
   3.9536451980266533`*^9}, {3.953645260755282*^9, 3.953645272289468*^9}, 
   3.9536453233211985`*^9, {3.953647272831483*^9, 3.95364727398207*^9}, {
   3.9536473067595997`*^9, 3.953647306850708*^9}, {3.953651153287588*^9, 
   3.953651153314209*^9}, 3.953658330486951*^9, {3.967871019081474*^9, 
   3.967871020100986*^9}, {3.967871112287766*^9, 3.967871112365245*^9}, 
   3.967948522956469*^9, {3.970654441051282*^9, 3.9706544434118147`*^9}, {
   3.97065450374989*^9, 3.97065450796665*^9}, {3.970654579485561*^9, 
   3.970654579712312*^9}, {3.97065464053242*^9, 3.970654649833244*^9}, {
   3.970654989613865*^9, 3.970654994992871*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"8c440101-ff78-4822-96ee-a3b29ea09871"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"selectedSubsets", "=", 
     RowBox[{"SelectSubsets", "[", 
      RowBox[{"allSubsets", ",", "n", ",", "threshold"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"pos1", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"k", ",", 
       RowBox[{"Function", "[", 
        RowBox[{"w", ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"r", "=", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", "k", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", "w", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{"1", ",", 
               RowBox[{"{", 
                RowBox[{"Length", "[", "w", "]"}], "}"}]}], "]"}]}], ";", 
            "\n", "r"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"M", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{"pos1", "[", "m", "]"}], ",", "selectedSubsets"}], "]"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{"MatrixForm", "[", "M", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.953645294505362*^9, 3.953645332046687*^9}, {
   3.953647280765694*^9, 3.9536472865812817`*^9}, {3.953647350396455*^9, 
   3.95364735056964*^9}, {3.953648016168172*^9, 3.953648036278876*^9}, {
   3.95365116251295*^9, 3.953651162717479*^9}, {3.953658342590093*^9, 
   3.953658343817984*^9}, {3.967871028485051*^9, 3.96787103163672*^9}, {
   3.967871118486504*^9, 3.967871118578536*^9}, {3.967871318848547*^9, 
   3.967871334915344*^9}, {3.9679485309361258`*^9, 3.9679485310435753`*^9}, 
   3.9706545766035357`*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"30df5468-ab0a-4cfb-b55c-a46b29085b12"],

Cell[CellGroupData[{

Cell[BoxData["2"], "Print",
 CellChangeTimes->{
  3.953645334877817*^9, {3.953647287219903*^9, 3.953647309904765*^9}, {
   3.953647351145889*^9, 3.953647359273883*^9}, {3.953648017574649*^9, 
   3.953648036708531*^9}, 3.953650000935665*^9, 3.953651163150188*^9, {
   3.95365833720229*^9, 3.953658344299296*^9}, 3.953658665974711*^9, {
   3.967871032068397*^9, 3.967871047106514*^9}, 3.96787112386087*^9, {
   3.967871319623274*^9, 3.9678713353634443`*^9}, 3.967871407930995*^9, 
   3.967871510462881*^9, 3.967948535467994*^9, 3.970654680525673*^9, 
   3.970655001543257*^9, 3.9706673968994083`*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"9071a1d8-7b23-4d40-b2d4-908ff328e304"],

Cell[BoxData["3"], "Print",
 CellChangeTimes->{
  3.953645334877817*^9, {3.953647287219903*^9, 3.953647309904765*^9}, {
   3.953647351145889*^9, 3.953647359273883*^9}, {3.953648017574649*^9, 
   3.953648036708531*^9}, 3.953650000935665*^9, 3.953651163150188*^9, {
   3.95365833720229*^9, 3.953658344299296*^9}, 3.953658665974711*^9, {
   3.967871032068397*^9, 3.967871047106514*^9}, 3.96787112386087*^9, {
   3.967871319623274*^9, 3.9678713353634443`*^9}, 3.967871407930995*^9, 
   3.967871510462881*^9, 3.967948535467994*^9, 3.970654680525673*^9, 
   3.970655001543257*^9, 3.970667396899798*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"69eac20c-24b7-4af0-853b-ad542ba646ae"],

Cell[BoxData["4"], "Print",
 CellChangeTimes->{
  3.953645334877817*^9, {3.953647287219903*^9, 3.953647309904765*^9}, {
   3.953647351145889*^9, 3.953647359273883*^9}, {3.953648017574649*^9, 
   3.953648036708531*^9}, 3.953650000935665*^9, 3.953651163150188*^9, {
   3.95365833720229*^9, 3.953658344299296*^9}, 3.953658665974711*^9, {
   3.967871032068397*^9, 3.967871047106514*^9}, 3.96787112386087*^9, {
   3.967871319623274*^9, 3.9678713353634443`*^9}, 3.967871407930995*^9, 
   3.967871510462881*^9, 3.967948535467994*^9, 3.970654680525673*^9, 
   3.970655001543257*^9, 3.97066739690016*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"95da5b9a-dc76-4932-bec3-63effa7dbbe1"],

Cell[BoxData["5"], "Print",
 CellChangeTimes->{
  3.953645334877817*^9, {3.953647287219903*^9, 3.953647309904765*^9}, {
   3.953647351145889*^9, 3.953647359273883*^9}, {3.953648017574649*^9, 
   3.953648036708531*^9}, 3.953650000935665*^9, 3.953651163150188*^9, {
   3.95365833720229*^9, 3.953658344299296*^9}, 3.953658665974711*^9, {
   3.967871032068397*^9, 3.967871047106514*^9}, 3.96787112386087*^9, {
   3.967871319623274*^9, 3.9678713353634443`*^9}, 3.967871407930995*^9, 
   3.967871510462881*^9, 3.967948535467994*^9, 3.970654680525673*^9, 
   3.970655001543257*^9, 3.970667396900384*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"56373a30-33b0-4b07-aaba-04557c05956a"],

Cell[BoxData["6"], "Print",
 CellChangeTimes->{
  3.953645334877817*^9, {3.953647287219903*^9, 3.953647309904765*^9}, {
   3.953647351145889*^9, 3.953647359273883*^9}, {3.953648017574649*^9, 
   3.953648036708531*^9}, 3.953650000935665*^9, 3.953651163150188*^9, {
   3.95365833720229*^9, 3.953658344299296*^9}, 3.953658665974711*^9, {
   3.967871032068397*^9, 3.967871047106514*^9}, 3.96787112386087*^9, {
   3.967871319623274*^9, 3.9678713353634443`*^9}, 3.967871407930995*^9, 
   3.967871510462881*^9, 3.967948535467994*^9, 3.970654680525673*^9, 
   3.970655001543257*^9, 3.970667396900597*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"9fd61195-bb16-46a8-afc2-e5bea68b2910"],

Cell[BoxData["7"], "Print",
 CellChangeTimes->{
  3.953645334877817*^9, {3.953647287219903*^9, 3.953647309904765*^9}, {
   3.953647351145889*^9, 3.953647359273883*^9}, {3.953648017574649*^9, 
   3.953648036708531*^9}, 3.953650000935665*^9, 3.953651163150188*^9, {
   3.95365833720229*^9, 3.953658344299296*^9}, 3.953658665974711*^9, {
   3.967871032068397*^9, 3.967871047106514*^9}, 3.96787112386087*^9, {
   3.967871319623274*^9, 3.9678713353634443`*^9}, 3.967871407930995*^9, 
   3.967871510462881*^9, 3.967948535467994*^9, 3.970654680525673*^9, 
   3.970655001543257*^9, 3.970667396900811*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"96d9931d-7235-4fb2-b34d-4a42f571e911"],

Cell[BoxData["8"], "Print",
 CellChangeTimes->{
  3.953645334877817*^9, {3.953647287219903*^9, 3.953647309904765*^9}, {
   3.953647351145889*^9, 3.953647359273883*^9}, {3.953648017574649*^9, 
   3.953648036708531*^9}, 3.953650000935665*^9, 3.953651163150188*^9, {
   3.95365833720229*^9, 3.953658344299296*^9}, 3.953658665974711*^9, {
   3.967871032068397*^9, 3.967871047106514*^9}, 3.96787112386087*^9, {
   3.967871319623274*^9, 3.9678713353634443`*^9}, 3.967871407930995*^9, 
   3.967871510462881*^9, 3.967948535467994*^9, 3.970654680525673*^9, 
   3.970655001543257*^9, 3.970667396901022*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"911e6064-ed69-4dc9-bd4b-c54c1fb6d6ae"],

Cell[BoxData["9"], "Print",
 CellChangeTimes->{
  3.953645334877817*^9, {3.953647287219903*^9, 3.953647309904765*^9}, {
   3.953647351145889*^9, 3.953647359273883*^9}, {3.953648017574649*^9, 
   3.953648036708531*^9}, 3.953650000935665*^9, 3.953651163150188*^9, {
   3.95365833720229*^9, 3.953658344299296*^9}, 3.953658665974711*^9, {
   3.967871032068397*^9, 3.967871047106514*^9}, 3.96787112386087*^9, {
   3.967871319623274*^9, 3.9678713353634443`*^9}, 3.967871407930995*^9, 
   3.967871510462881*^9, 3.967948535467994*^9, 3.970654680525673*^9, 
   3.970655001543257*^9, 3.97066739690123*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"93258034-40aa-49d7-a00f-d89d6f6e6785"],

Cell[BoxData["10"], "Print",
 CellChangeTimes->{
  3.953645334877817*^9, {3.953647287219903*^9, 3.953647309904765*^9}, {
   3.953647351145889*^9, 3.953647359273883*^9}, {3.953648017574649*^9, 
   3.953648036708531*^9}, 3.953650000935665*^9, 3.953651163150188*^9, {
   3.95365833720229*^9, 3.953658344299296*^9}, 3.953658665974711*^9, {
   3.967871032068397*^9, 3.967871047106514*^9}, 3.96787112386087*^9, {
   3.967871319623274*^9, 3.9678713353634443`*^9}, 3.967871407930995*^9, 
   3.967871510462881*^9, 3.967948535467994*^9, 3.970654680525673*^9, 
   3.970655001543257*^9, 3.970667396901444*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"90adc75e-d301-4387-a13e-e4f5630958a0"],

Cell[BoxData["11"], "Print",
 CellChangeTimes->{
  3.953645334877817*^9, {3.953647287219903*^9, 3.953647309904765*^9}, {
   3.953647351145889*^9, 3.953647359273883*^9}, {3.953648017574649*^9, 
   3.953648036708531*^9}, 3.953650000935665*^9, 3.953651163150188*^9, {
   3.95365833720229*^9, 3.953658344299296*^9}, 3.953658665974711*^9, {
   3.967871032068397*^9, 3.967871047106514*^9}, 3.96787112386087*^9, {
   3.967871319623274*^9, 3.9678713353634443`*^9}, 3.967871407930995*^9, 
   3.967871510462881*^9, 3.967948535467994*^9, 3.970654680525673*^9, 
   3.970655001543257*^9, 3.970667396901669*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"6266699b-eca8-4c7c-aba4-b76231989342"],

Cell[BoxData["1"], "Print",
 CellChangeTimes->{
  3.953645334877817*^9, {3.953647287219903*^9, 3.953647309904765*^9}, {
   3.953647351145889*^9, 3.953647359273883*^9}, {3.953648017574649*^9, 
   3.953648036708531*^9}, 3.953650000935665*^9, 3.953651163150188*^9, {
   3.95365833720229*^9, 3.953658344299296*^9}, 3.953658665974711*^9, {
   3.967871032068397*^9, 3.967871047106514*^9}, 3.96787112386087*^9, {
   3.967871319623274*^9, 3.9678713353634443`*^9}, 3.967871407930995*^9, 
   3.967871510462881*^9, 3.967948535467994*^9, 3.970654680525673*^9, 
   3.970655001543257*^9, 3.97066739690191*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"938e39f9-5c10-4298-8c89-5daa55637d36"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "1", "0", "0", "1", "0", "0", "1", "0"},
     {"1", "0", "0", "0", "1", "0", "0", "1", "0", "0", "1"},
     {"1", "0", "0", "0", "0", "1", "0", "0", "1", "0", "0"},
     {"0", "1", "0", "1", "0", "0", "0", "0", "1", "0", "1"},
     {"0", "1", "0", "0", "1", "0", "1", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "1", "0", "1", "0", "1", "0"},
     {"0", "0", "1", "1", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "1", "0", "0", "0", "1", "1", "0"},
     {"0", "0", "1", "0", "0", "1", "1", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.953645335024129*^9, {3.953647287279713*^9, 3.953647309955268*^9}, {
   3.953647351191584*^9, 3.953647359318701*^9}, {3.953648017582048*^9, 
   3.953648036718237*^9}, 3.953650000943145*^9, 3.9536511631604137`*^9, {
   3.953658337212009*^9, 3.953658344340839*^9}, 3.953658666022398*^9, {
   3.967871032076256*^9, 3.967871047111401*^9}, 3.967871123864326*^9, {
   3.967871319627991*^9, 3.967871335368021*^9}, 3.967871407936559*^9, 
   3.967871510467004*^9, 3.9679485354723682`*^9, 3.970654680530291*^9, 
   3.970655001546986*^9, 3.970667396902409*^9},
 CellLabel->
  "Out[13]//MatrixForm=",ExpressionUUID->"53b390b9-fcbb-4cd1-8014-\
fccb4ea2ec2a"]
}, Open  ]],

Cell["\<\
Now  we will populate the matrix will elements from GF(2^p) for that we need \
to fix the value of p\
\>", "Text",
 CellChangeTimes->{{3.970654697122889*^9, 
  3.9706547311922197`*^9}},ExpressionUUID->"c22a5c98-2919-4be8-8795-\
f4da6ff564f8"],

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<FiniteFields`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gf", "=", 
   RowBox[{"GF", "[", 
    RowBox[{"2", ",", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gfz", "=", 
   RowBox[{"gf", "[", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "p"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.9536453885996227`*^9, {3.95364555352699*^9, 3.953645554758364*^9}, {
   3.953646271915601*^9, 3.953646279926731*^9}, {3.953646771982467*^9, 
   3.953646772324141*^9}, {3.953648249595184*^9, 3.953648293516614*^9}, {
   3.953648729070465*^9, 3.9536487291103067`*^9}, {3.953648767020563*^9, 
   3.953648803843028*^9}, {3.953649416568552*^9, 3.953649443356917*^9}, {
   3.953649486559915*^9, 3.953649486902155*^9}, {3.953650743163809*^9, 
   3.953650818474345*^9}, {3.953650883460451*^9, 3.953650883519348*^9}, {
   3.953650979177229*^9, 3.953650979251354*^9}, {3.953651838724519*^9, 
   3.9536518387830057`*^9}, {3.953652190790762*^9, 3.953652190878357*^9}, {
   3.953653544428409*^9, 3.953653544800758*^9}, 3.953654606095064*^9, {
   3.953655720499961*^9, 3.9536557205895863`*^9}, {3.967871079901903*^9, 
   3.96787108021874*^9}, {3.967871143775091*^9, 3.967871157627037*^9}, {
   3.967948637434359*^9, 3.967948637499933*^9}, {3.970654708487861*^9, 
   3.970654708573969*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"36cf36c9-7c12-4ad8-9bf5-facfb69a3d76"],

Cell[BoxData[
 RowBox[{
  RowBox[{"genNZTable", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", "p"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"Plus", ",", " ", "r"}], "]"}], "==", "0"}], ",", 
          RowBox[{"r", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", "p"}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "r"}]}], "\[IndentingNewLine]", 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.953648947419881*^9, 3.953649022104977*^9}, {
  3.953649162583099*^9, 3.953649204046844*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"98685183-58d5-4642-b4cb-519867486fe4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"genranNZ", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", "p"}], "}"}], ",", 
     RowBox[{"gf", "[", 
      RowBox[{"genNZTable", "[", "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.953645411745741*^9, 3.953645488591288*^9}, {
  3.953645694619969*^9, 3.953645702527197*^9}, {3.953645793155385*^9, 
  3.9536457934102*^9}, {3.953649228917535*^9, 3.9536492517910633`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"67aea58a-2f32-4fde-81e6-07ca0602e7e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tfGF", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M", ",", "b", ",", "p"}], "}"}], ",", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], "=", 
         RowBox[{"Dimensions", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"M", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "==", "0"}], ",", " ",
               "gfz", ",", 
              RowBox[{"genranNZ", "[", 
               RowBox[{"2", ",", "p"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.95364606893572*^9, 3.953646227010494*^9}, {
  3.953646384449167*^9, 3.953646410732202*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"49e05afa-ba67-4098-bdcc-a2afaa274691"],

Cell["\<\
This  function ensures weather the matrix is an Maximum Distance Separable \
matrix. Note that this condition is particularly hard to obtain, we shall \
consider a less demanding condition.\
\>", "Text",
 CellChangeTimes->{{3.9536464135041428`*^9, 3.953646440356127*^9}, {
   3.953647162031833*^9, 3.95364716225543*^9}, 3.953648178434156*^9, {
   3.970654751164342*^9, 
   3.9706548058597927`*^9}},ExpressionUUID->"afb3cd5d-d522-4bed-90f7-\
771f92f6982b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.953646443026782*^9, 
  3.95364645367736*^9}},ExpressionUUID->"5ba14b5a-ca95-45d4-ab8c-\
15fd9032fbb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IsMDSMatrix", "[", 
   RowBox[{"A_", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "m", ",", "n", ",", "columnCombinations", ",", "submatrices", ",", 
      "determinants", ",", "b"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"First", ",", 
       RowBox[{
        RowBox[{
        "ensure", " ", "the", " ", "number", " ", "of", " ", "columns"}], ">=", 
        RowBox[{"number", " ", "of", " ", "rows"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"b", "=", "True"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "<", "m"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"False", ",", "Module"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Generate", " ", "all", " ", "possible", " ", "subsets", " ", "of", " ",
        "exactly", " ", "m", " ", "columns", " ", "from", " ", "the", " ", 
       "n", " ", "columns"}], "*)"}], 
     RowBox[{"columnCombinations", "=", 
      RowBox[{"Subsets", "[", 
       RowBox[{
        RowBox[{"Range", "[", "n", "]"}], ",", 
        RowBox[{"{", "m", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Extract", " ", "the", " ", "corresponding", " ", "submatrices"}], 
      "*)"}], 
     RowBox[{"submatrices", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
       "columnCombinations"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Compute", " ", "determinants", " ", "of", " ", "all", " ", "m", " ", 
        "x", " ", "m", " ", "submatrices", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<Testing the submatrices\>\"", "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Length", "[", "submatrices", "]"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Det", "[", 
           RowBox[{"submatrices", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "===", "0"}], ",", 
         RowBox[{
          RowBox[{"b", "=", "False"}], ";", " ", 
          RowBox[{"aux", "=", 
           RowBox[{"submatrices", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "submatrices", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"b", ",", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Sucess\>\"", "]"}], ";", 
        RowBox[{"Print", "[", "A", "]"}], ";", "True"}], ",", " ", "False"}], 
      "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Check", " ", "if", " ", "all", " ", "determinants", " ", "are", " ", 
     "nonzero"}], "*)"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.953646015868239*^9, 3.953646060820932*^9}, {
   3.953646541390711*^9, 3.95364654432476*^9}, {3.953646685926745*^9, 
   3.953646741381577*^9}, {3.953646861641213*^9, 3.953646909081193*^9}, {
   3.953646957853716*^9, 3.9536469871620913`*^9}, {3.953647031517235*^9, 
   3.9536470319675493`*^9}, {3.953647192936914*^9, 3.953647238354863*^9}, {
   3.9536483438740177`*^9, 3.953648410896977*^9}, {3.953649323778195*^9, 
   3.953649369993823*^9}, {3.953649404929335*^9, 3.9536494066243343`*^9}, {
   3.953649537534614*^9, 3.953649539687171*^9}, {3.9536495712226048`*^9, 
   3.953649587242284*^9}, {3.953649623140958*^9, 3.9536496293632364`*^9}, 
   3.953649982066229*^9, {3.953650022937126*^9, 3.953650038178664*^9}, {
   3.953650135006999*^9, 3.953650147549038*^9}, {3.953650647344047*^9, 
   3.953650676381387*^9}, {3.953650728853396*^9, 3.953650730250127*^9}, {
   3.95365101103806*^9, 3.9536510276347113`*^9}, 3.953651623334034*^9, {
   3.953656887643196*^9, 3.953656900329459*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"e17d131f-6dcb-43a2-9538-81e6d796ce2a"],

Cell["\<\
Next  we try to construct an MDS matrix populating the support of M with \
elements from the GF(2^p). The resulting matrix is stored in Mfinal\
\>", "Text",
 CellChangeTimes->{{3.9706548607324123`*^9, 
  3.970654892798688*^9}},ExpressionUUID->"d8136b9e-b1c5-424c-adbc-\
0fe99c645de6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Mfinal", "=", 
      RowBox[{"tfGF", "[", 
       RowBox[{"M", ",", "2", ",", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"IsMDSMatrix", "[", "Mfinal", "]"}], ",", " ", 
       RowBox[{"Return", "[", "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "200"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.953646476012599*^9, 3.953646476836148*^9}, {
   3.953647137728773*^9, 3.953647153949286*^9}, 3.953648190572132*^9, {
   3.953648309256496*^9, 3.953648316602517*^9}, 3.953648810486125*^9, 
   3.953649427276208*^9, {3.953649591318506*^9, 3.953649600774498*^9}, {
   3.953650013895941*^9, 3.953650013965288*^9}, {3.95365076570744*^9, 
   3.953650769199655*^9}, {3.953651032057378*^9, 3.953651043271634*^9}, {
   3.96787107503819*^9, 3.967871075786132*^9}, {3.970654845650262*^9, 
   3.970654848591068*^9}, 3.970654900641123*^9},
 CellLabel->"In[22]:=",ExpressionUUID->"62901909-39eb-4ab4-b4c8-a3680f8e2d61"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Sucess\"\>"], "Print",
 CellChangeTimes->{3.967871597258561*^9, 3.967948571436672*^9, 
  3.9679486569717484`*^9, 3.970654830810028*^9, 3.9706549105109243`*^9, 
  3.9706550481379437`*^9, 3.970667451175015*^9},
 CellLabel->
  "During evaluation of \
In[22]:=",ExpressionUUID->"9e333ecd-d45f-45d2-bcb3-4217d8c38b45"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}], "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "}"}], "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], ",", 
     SubscriptBox[
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}], "2"]}], "}"}]}], 
  "}"}]], "Print",
 CellChangeTimes->{3.967871597258561*^9, 3.967948571436672*^9, 
  3.9679486569717484`*^9, 3.970654830810028*^9, 3.9706549105109243`*^9, 
  3.9706550481379437`*^9, 3.970667451176188*^9},
 CellLabel->
  "During evaluation of \
In[22]:=",ExpressionUUID->"d4df827a-9263-41e0-b818-ff0ad892ba2e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "Mfinal", "]"}]], "Input",
 CellChangeTimes->{{3.953651109155449*^9, 3.953651112110399*^9}, 
   3.967871174857407*^9, 3.967871610625679*^9, 3.9679485800822287`*^9, 
   3.967948666272375*^9, {3.970654854290244*^9, 3.970654857322432*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"e2c393f6-6f17-476e-a3fa-862abcc8d117"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"]},
     {
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}], "2"]},
     {
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"]},
     {
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "}"}], "2"]},
     {
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"]},
     {
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"]},
     {
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"]},
     {
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"]},
     {
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "2"], 
      SubscriptBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.953651112675476*^9, 3.9678711755291653`*^9, 
  3.9678716117656603`*^9, 3.967948582070216*^9, 3.967948667321167*^9, 
  3.970654913199748*^9, 3.970655051509373*^9, 3.970655651248372*^9, 
  3.9706674607663803`*^9},
 CellLabel->
  "Out[23]//MatrixForm=",ExpressionUUID->"6a664042-0493-4423-aa8c-\
ee91e2ccd970"]
}, Open  ]],

Cell["\<\
We  can  now  convert  this  matrix to C to place in the code  (in this case \
just for p=4)\
\>", "Text",
 CellChangeTimes->{{3.9706549510163717`*^9, 3.970654963223371*^9}, {
  3.970655056800149*^9, 3.9706550798337183`*^9}, {3.9706551656191273`*^9, 
  3.97065517286049*^9}},ExpressionUUID->"c96079ec-995c-421e-87ee-\
c06013b628dc"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Replace", " ", 
    RowBox[{"Subscript", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", "2"}], "]"}], 
    " ", "with", " ", "the", " ", "integer", " ", "in", " ", "little"}], "-", 
   
   RowBox[{"endian", " ", "order"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.970655158515229*^9, 3.970655226858698*^9}, {
  3.970655262255898*^9, 
  3.970655321036834*^9}},ExpressionUUID->"c27e265f-a993-4228-9143-\
fb6104f01318"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tolend", "[", 
   RowBox[{"{", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "}"}], "]"}], ":=", 
  RowBox[{"a", "+", 
   RowBox[{"2", " ", "b"}], "+", 
   RowBox[{"4", " ", "c"}], "+", 
   RowBox[{"8", " ", "d"}]}]}], "\n", 
 RowBox[{
  RowBox[{"Mdist", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"M", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"tolend", "[", 
        RowBox[{"M", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"M", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"littleEndianMatrix", "=", 
  RowBox[{"Mdist", "[", "Mfinal", "]"}]}]}], "Input",
 CellChangeTimes->{{3.970655158515229*^9, 3.970655226858698*^9}, {
  3.970655262255898*^9, 3.970655321036834*^9}, {3.9706553884115953`*^9, 
  3.970655576344843*^9}, {3.970655663774913*^9, 3.97065567725254*^9}, {
  3.970655715740507*^9, 3.970655756924312*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"28a071f1-4362-45bc-a9f1-33ad26e31b31"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "3", ",", "11", ",", "5", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "14", ",", "14", ",", "3", ",", "0", ",", 
     "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "10", ",", 
     "14", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "14", ",", "0", ",", "0", ",", "2", ",", "0", ",", "0", ",", "13", ",", 
     "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "7", ",", "0", ",", "0", ",", "9", ",", "0", ",", "0", ",", 
     "11", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "5", ",", "0", ",", "0", ",", "4", ",", "0", ",", "0",
      ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "10", ",", "0", ",", "0", ",", "0", ",", "9", ",", "0", ",", "0", ",", 
     "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "6", ",", "0", ",", "0", ",", "0", ",", "12", ",", "2", ",", 
     "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "7", ",", "13", ",", "0", ",", "0", ",", "0", ",", 
     "5", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "11", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ",", "0", ",", 
     "10", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "5", ",", "0", ",", "13", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "7"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.970655757495394*^9, 3.9706674671545687`*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"a14bcee3-483d-408e-aaf7-f7acc405ca35"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Format", " ", "as", " ", "C", " ", "array", " ", "as", " ", "matrix"}], 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"cArrayString", "=", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"littleEndianMatrix", ",", "InputForm"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
         RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{"Print", "[", "cArrayString", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.970655158515229*^9, 3.970655226858698*^9}, {
  3.970655262255898*^9, 3.970655321036834*^9}, {3.9706557738332443`*^9, 
  3.970655806362627*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"57973a99-36d5-45a5-8bea-03a24624f93a"],

Cell[BoxData["\<\"[[3, 11, 5, 0, 0, 0, 0, 0, 0], [0, 0, 0, 14, 14, 3, 0, 0, \
0], [0, 0, 0, 0, 0, 0, 10, 14, 4], [14, 0, 0, 2, 0, 0, 13, 0, 0], [0, 7, 0, \
0, 9, 0, 0, 11, 0], [0, 0, 5, 0, 0, 4, 0, 0, 15], [10, 0, 0, 0, 9, 0, 0, 0, \
1], [0, 6, 0, 0, 0, 12, 2, 0, 0], [0, 0, 7, 13, 0, 0, 0, 5, 0], [11, 0, 0, 0, \
0, 8, 0, 10, 0], [0, 5, 0, 13, 0, 0, 0, 0, 7]]\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.970655175592123*^9, 3.970655181475508*^9}, 
   3.970655227482682*^9, 3.970655279184942*^9, 3.970655760184205*^9, 
   3.970667469898658*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"b1d26bea-7826-49d4-8075-bdd9509e2bb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Format", " ", "as", " ", "C", " ", "array", " ", "as", " ", "vector"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cArrayString", "=", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "littleEndianMatrix", "]"}], ",", 
         "InputForm"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<{\>\"", "->", "\"\<[\>\""}], ",", 
         RowBox[{"\"\<}\>\"", "->", "\"\<]\>\""}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{"Print", "[", "cArrayString", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.970655811667349*^9, 3.970655822826248*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"9f4c0034-389d-4d9b-a00d-a81723acded7"],

Cell[BoxData["\<\"[4, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 7, 12, 0, 0, 0, 0, \
0, 0, 0, 0, 0, 3, 14, 15, 15, 0, 0, 3, 0, 0, 9, 0, 0, 0, 8, 0, 0, 6, 0, 0, \
10, 0, 0, 0, 14, 0, 0, 4, 0, 0, 6, 9, 0, 0, 0, 6, 0, 0, 0, 7, 0, 2, 0, 0, 0, \
1, 11, 0, 0, 0, 0, 5, 2, 0, 0, 0, 4, 0, 5, 0, 0, 0, 0, 14, 0, 6, 0, 0, 6, 0, \
11, 0, 0, 0, 0, 5]\"\>"], "Print",
 CellChangeTimes->{3.970655823066592*^9},
 CellLabel->
  "During evaluation of \
In[166]:=",ExpressionUUID->"8a71636e-7135-49b7-919f-7531fb08e940"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1184, 462},
WindowMargins->{{83, Automatic}, {Automatic, 151}},
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"9143c692-b974-4490-812a-5743f5f4a3ef"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 163, 3, 98, "Title",ExpressionUUID->"5d3e0085-4626-4c45-8196-a32bc093ff3a"],
Cell[746, 27, 175, 6, 85, "Subtitle",ExpressionUUID->"19f90c68-791e-405a-a73a-8963bf01064a"],
Cell[924, 35, 511, 14, 150, "Text",ExpressionUUID->"99b53cfc-1d3e-40af-a5fc-332fccec28c1"],
Cell[1438, 51, 10795, 226, 1018, "Input",ExpressionUUID->"8c440101-ff78-4822-96ee-a3b29ea09871"],
Cell[CellGroupData[{
Cell[12258, 281, 1968, 47, 241, "Input",ExpressionUUID->"30df5468-ab0a-4cfb-b55c-a46b29085b12"],
Cell[CellGroupData[{
Cell[14251, 332, 703, 12, 24, "Print",ExpressionUUID->"9071a1d8-7b23-4d40-b2d4-908ff328e304"],
Cell[14957, 346, 701, 12, 24, "Print",ExpressionUUID->"69eac20c-24b7-4af0-853b-ad542ba646ae"],
Cell[15661, 360, 700, 12, 24, "Print",ExpressionUUID->"95da5b9a-dc76-4932-bec3-63effa7dbbe1"],
Cell[16364, 374, 701, 12, 24, "Print",ExpressionUUID->"56373a30-33b0-4b07-aaba-04557c05956a"],
Cell[17068, 388, 701, 12, 24, "Print",ExpressionUUID->"9fd61195-bb16-46a8-afc2-e5bea68b2910"],
Cell[17772, 402, 701, 12, 24, "Print",ExpressionUUID->"96d9931d-7235-4fb2-b34d-4a42f571e911"],
Cell[18476, 416, 701, 12, 24, "Print",ExpressionUUID->"911e6064-ed69-4dc9-bd4b-c54c1fb6d6ae"],
Cell[19180, 430, 700, 12, 24, "Print",ExpressionUUID->"93258034-40aa-49d7-a00f-d89d6f6e6785"],
Cell[19883, 444, 702, 12, 24, "Print",ExpressionUUID->"90adc75e-d301-4387-a13e-e4f5630958a0"],
Cell[20588, 458, 702, 12, 24, "Print",ExpressionUUID->"6266699b-eca8-4c7c-aba4-b76231989342"],
Cell[21293, 472, 700, 12, 24, "Print",ExpressionUUID->"938e39f9-5c10-4298-8c89-5daa55637d36"]
}, Open  ]],
Cell[22008, 487, 1675, 34, 181, "Output",ExpressionUUID->"53b390b9-fcbb-4cd1-8014-fccb4ea2ec2a"]
}, Open  ]],
Cell[23698, 524, 252, 6, 35, "Text",ExpressionUUID->"c22a5c98-2919-4be8-8795-f4da6ff564f8"],
Cell[23953, 532, 1581, 32, 94, "Input",ExpressionUUID->"36cf36c9-7c12-4ad8-9bf5-facfb69a3d76"],
Cell[25537, 566, 1228, 32, 115, "Input",ExpressionUUID->"98685183-58d5-4642-b4cb-519867486fe4"],
Cell[26768, 600, 545, 12, 30, "Input",ExpressionUUID->"67aea58a-2f32-4fde-81e6-07ca0602e7e5"],
Cell[27316, 614, 1472, 39, 157, "Input",ExpressionUUID->"49e05afa-ba67-4098-bdcc-a2afaa274691"],
Cell[28791, 655, 465, 9, 58, "Text",ExpressionUUID->"afb3cd5d-d522-4bed-90f7-771f92f6982b"],
Cell[29259, 666, 151, 3, 30, "Input",ExpressionUUID->"5ba14b5a-ca95-45d4-ab8c-15fd9032fbb6"],
Cell[29413, 671, 4377, 102, 283, "Input",ExpressionUUID->"e17d131f-6dcb-43a2-9538-81e6d796ce2a"],
Cell[33793, 775, 294, 6, 35, "Text",ExpressionUUID->"d8136b9e-b1c5-424c-adbc-0fe99c645de6"],
Cell[CellGroupData[{
Cell[34112, 785, 1074, 22, 82, "Input",ExpressionUUID->"62901909-39eb-4ab4-b4c8-a3680f8e2d61"],
Cell[CellGroupData[{
Cell[35211, 811, 331, 6, 24, "Print",ExpressionUUID->"9e333ecd-d45f-45d2-bcb3-4217d8c38b45"],
Cell[35545, 819, 11587, 324, 177, "Print",ExpressionUUID->"d4df827a-9263-41e0-b818-ff0ad892ba2e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47181, 1149, 357, 5, 30, "Input",ExpressionUUID->"e2c393f6-6f17-476e-a3fa-862abcc8d117"],
Cell[47541, 1156, 11532, 326, 191, "Output",ExpressionUUID->"6a664042-0493-4423-aa8c-ee91e2ccd970"]
}, Open  ]],
Cell[59088, 1485, 342, 7, 35, "Text",ExpressionUUID->"c96079ec-995c-421e-87ee-c06013b628dc"],
Cell[59433, 1494, 527, 14, 30, "Input",ExpressionUUID->"c27e265f-a993-4228-9143-fb6104f01318"],
Cell[CellGroupData[{
Cell[59985, 1512, 1317, 34, 73, "Input",ExpressionUUID->"28a071f1-4362-45bc-a9f1-33ad26e31b31"],
Cell[61305, 1548, 1753, 48, 77, "Output",ExpressionUUID->"a14bcee3-483d-408e-aaf7-f7acc405ca35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63095, 1601, 873, 22, 94, "Input",ExpressionUUID->"57973a99-36d5-45a5-8bea-03a24624f93a"],
Cell[63971, 1625, 693, 12, 63, "Print",ExpressionUUID->"b1d26bea-7826-49d4-8075-bdd9509e2bb1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64701, 1642, 822, 23, 73, "Input",ExpressionUUID->"9f4c0034-389d-4d9b-a00d-a81723acded7"],
Cell[65526, 1667, 496, 8, 63, "Print",ExpressionUUID->"8a71636e-7135-49b7-919f-7531fb08e940"]
}, Open  ]]
}, Open  ]]
}
]
*)

